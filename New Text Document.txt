package com.tests;

import java.io.File;
import java.io.IOException;
import java.time.Duration;

import org.apache.commons.io.FileUtils;
import org.openqa.selenium.By;
import org.openqa.selenium.OutputType;
import org.openqa.selenium.TakesScreenshot;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.testng.Assert;
import org.testng.annotations.Test;


public class TestSaucedemo {
	
	public static WebDriver driver; // declare a global variable name "driver" which we use in all the packages
	//public static WebElement element; // declare a global variable name "element" which we use in all the packages

	
	public static void takenScreenShots() {
		TakesScreenshot tsv = ((TakesScreenshot) driver);
		File src = tsv.getScreenshotAs(OutputType.FILE);
		String destfile = System.getProperty("user.dir") + "\screenshots\\img" + ".png";
		File destination = new File(destfile);
		try {
			FileUtils.copyFile(src, destination);
		}
		catch(IOException est)
		{
			est.printStackTrace();
		}
	}

	@Test
	public void testSauce() {
		
		//WebDriver driver = new FirefoxDriver();
		
		driver = new FirefoxDriver();
		
		driver.manage().window().maximize();
		
		driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(200));
		
		driver.get("https://www.saucedemo.com/");
		
		takenScreenShots();
		
	    driver.findElement(By.xpath("//input[@id='user-name']")).sendKeys("standard_user");
	    
	    driver.findElement(By.xpath("//input[@placeholder='Password']")).sendKeys("secret_sauce");
	    
	    driver.findElement(By.xpath("//input[@id='login-button']")).click();
	    
	    driver.findElement(By.xpath("//div[div[text() = '9.99']]/button")).click();
	    
	    takenScreenShots();
	    
	    driver.findElement(By.xpath("//a[@class='shopping_cart_link']")).click();
	    
	    driver.findElement(By.xpath("//button[@id='checkout']")).click();
	    
	    driver.findElement(By.xpath("//input[@id='first-name']")).sendKeys("Khush");
	    
	    driver.findElement(By.xpath("//input[@id='last-name']")).sendKeys("Roy");
	    
	    driver.findElement(By.xpath("//input[@id='postal-code']")).sendKeys("455001");
	    
	    driver.findElement(By.xpath("//input[@id='continue']")).click();
	    
	    driver.findElement(By.xpath("//button[@id='finish']")).click();
	    
	    WebElement msg = driver.findElement(By.xpath("//h2[text() = 'Thank you for your order!']"));
	    String actual = msg.getText();
	    Assert.assertEquals(actual, "Thank you for your order!");
	    
	    takenScreenShots();
	    
		
		//driver.findElement(By.linkText(""));
	}

}
